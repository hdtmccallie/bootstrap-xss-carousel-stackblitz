<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Home</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />

    <link
      rel="stylesheet"
      href="https://cdn.staticfile.net/twitter-bootstrap/3.4.1/css/bootstrap.min.css"
    />
    <script src="https://cdn.staticfile.net/jquery/2.1.1/jquery.min.js"></script>
    <script src="bootstrap.js"></script>

    <!--
      Need a visual blank slate?
      Remove all code in `styles.css`!
    -->
    <link rel="stylesheet" href="styles.css" />
    <script type="module" src="script.js"></script>
  </head>
  <body>
    <nav>
      <a href="index.html">Original</a>
      <a href="fixed.html">Fixed</a>
    </nav>
    <main>
      <h1>Boostrap 3.4.1 XSS Carousel Component Reproduction</h1>
      <h2>XSS Attempts - Carousel</h2>

      <h3><code>javascript:alert()</code></h3>

      <div class="carousel-container">
        <div id="myCarousel" class="carousel slide">
          <ol class="carousel-indicators">
            <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
            <li data-target="#myCarousel" data-slide-to="1"></li>
          </ol>
          <div class="carousel-inner">
            <div class="item active">
              <img
                src="https://placeholder.pics/svg/500x200/DEDEDE/555555/Slide%201"
                alt="First slide"
                data-holder-rendered="true"
              />
              <div class="carousel-caption">title 1</div>
            </div>
            <div class="item">
              <img
                src="https://placeholder.pics/svg/500x200/1A12FF-DCE9FF/Slide%202"
                alt="Second slide"
                data-holder-rendered="true"
              />
              <div class="carousel-caption">title 2</div>
            </div>
          </div>
        </div>
        <a
          href="javascript:alert('XSS href')"
          class="left"
          role="button"
          data-slide="prev"
        >
          <span>Previous (href)</span>
        </a>
        <!-- href="javascript:alert('XSS href')" -->
        <a
          href="#myCarousel"
          data-target="javascript:alert('XSS href')"
          class="right"
          role="button"
          data-slide="next"
        >
          <span>Next (data-target)</span>
        </a>
      </div>

      <hr />

      <h3>
        <code>
          &lt;&lt;script&gt;javascript: alert('XSS'); &lt;/script&gt;
        </code>
      </h3>

      <div class="carousel-container">
        <div id="myCarousel2" class="carousel slide">
          <ol class="carousel-indicators">
            <li
              data-target="#myCarousel2"
              data-slide-to="0"
              class="active"
            ></li>
            <li data-target="#myCarousel2" data-slide-to="1"></li>
          </ol>
          <div class="carousel-inner">
            <div class="item active">
              <img
                src="https://placeholder.pics/svg/500x200/DEDEDE/555555/Slide%201"
                alt="First slide"
                data-holder-rendered="true"
              />
              <div class="carousel-caption">title 1</div>
            </div>
            <div class="item">
              <img
                src="https://placeholder.pics/svg/500x200/1A12FF-DCE9FF/Slide%202"
                alt="Second slide"
                data-holder-rendered="true"
              />
              <div class="carousel-caption">title 2</div>
            </div>
          </div>
        </div>
        <a
          href="<<script>javascript:alert('XSS href')</script>"
          class="left"
          role="button"
          data-slide="prev"
        >
          <span>Previous (href)</span>
        </a>
        <!-- href="javascript:alert('XSS href')" -->
        <a
          href="#myCarousel2"
          data-target="<<script>javascript:alert('XSS data-target')</script>"
          class="right"
          role="button"
          data-slide="next"
        >
          <span>Next (data-target)</span>
        </a>
      </div>

      <hr />

      <h2>Normal Functionality</h2>

      <h3>
        <code>#myCarousel3</code>
      </h3>

      <div class="carousel-container">
        <div id="myCarousel3" class="carousel slide">
          <ol class="carousel-indicators">
            <li
              data-target="#myCarousel3"
              data-slide-to="0"
              class="active"
            ></li>
            <li data-target="#myCarousel3" data-slide-to="1"></li>
          </ol>
          <div class="carousel-inner">
            <div class="item active">
              <img
                src="https://placeholder.pics/svg/500x200/DEDEDE/555555/Slide%201"
                alt="First slide"
                data-holder-rendered="true"
              />
              <div class="carousel-caption">title 1</div>
            </div>
            <div class="item">
              <img
                src="https://placeholder.pics/svg/500x200/1A12FF-DCE9FF/Slide%202"
                alt="Second slide"
                data-holder-rendered="true"
              />
              <div class="carousel-caption">title 2</div>
            </div>
          </div>
        </div>
        <a href="#myCarousel3" class="left" role="button" data-slide="prev">
          <span>Previous (href)</span>
        </a>
        <a
          href="#myCarousel3"
          data-target="#myCarousel3"
          class="right"
          role="button"
          data-slide="next"
        >
          <span>Next (data-target)</span>
        </a>
      </div>

      <h3>
        <code>#someHash#myCarousel4</code>
      </h3>

      <div class="carousel-container">
        <div id="myCarousel4" class="carousel slide">
          <ol class="carousel-indicators">
            <li
              data-target="#myCarousel4"
              data-slide-to="0"
              class="active"
            ></li>
            <li data-target="#myCarousel4" data-slide-to="1"></li>
          </ol>
          <div class="carousel-inner">
            <div class="item active">
              <img
                src="https://placeholder.pics/svg/500x200/DEDEDE/555555/Slide%201"
                alt="First slide"
                data-holder-rendered="true"
              />
              <div class="carousel-caption">title 1</div>
            </div>
            <div class="item">
              <img
                src="https://placeholder.pics/svg/500x200/1A12FF-DCE9FF/Slide%202"
                alt="Second slide"
                data-holder-rendered="true"
              />
              <div class="carousel-caption">title 2</div>
            </div>
          </div>
        </div>
        <a
          href="#someHash#myCarousel4"
          class="left"
          role="button"
          data-slide="prev"
        >
          <span>Previous (href)</span>
        </a>
        <a
          href="#someHash#myCarousel4"
          data-target="#someHash#myCarousel4"
          class="right"
          role="button"
          data-slide="next"
        >
          <span>Next (data-target)</span>
        </a>
      </div>

      <hr />

      <hr />

      <h3>Dropdown</h3>

      <div class="dropdown">
        <button
          id="dLabel"
          type="button"
          data-toggle="dropdown"
          aria-haspopup="true"
          aria-expanded="false"
        >
          Dropdown trigger
          <span class="caret"></span>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dLabel">
          <li>
            <a
              href="<<script>javascript:alert('XSS href')</script>"
              class="dropdown-toggle"
              data-toggle="dropdown"
              >data-toggle</a
            >
          </li>
          <li><a href="javascript:alert('XSS');">vanilla html </a></li>
        </ul>
      </div>

      <div class="container">
        <h2>Bootstrap Alert Example</h2>
        <div
          id="myAlert"
          class="alert alert-success alert-dismissible fade in"
          role="alert"
          style="display: none"
        >
          <button
            type="button"
            class="close"
            data-dismiss="alert"
            aria-label="Close"
          >
            <span aria-hidden="true">&times;</span>
          </button>
          <strong>Success!</strong> This is a success alert message.
        </div>
        <button
          id="show-alert"
          class="btn btn-primary"
          data-target="#myAlert"
          data-toggle="alert"
        >
          Show Alert
        </button>
      </div>

      <script>
        $(document).ready(function () {
          $('#show-alert').click(function () {
            var target = $(this).data('target');
            $(target).fadeIn();
          });
        });
      </script>
      <p>
        <a
          href="asdfasdfa#section#myAlert"
          data-dismiss="alert"
          aria-label="Close"
          >close</a
        >
      </p>
    </main>
  </body>
</html>
